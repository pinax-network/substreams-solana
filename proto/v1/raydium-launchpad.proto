syntax = "proto3";

package raydium.launchpad.v1;

// -----------------------------------------------------------------------------
// Top-level containers
// -----------------------------------------------------------------------------
message Events {
  repeated Transaction transactions = 1;
}

message Transaction {
  bytes signature                   = 1;
  bytes fee_payer                   = 2;
  repeated bytes signers            = 3;
  uint64 fee                        = 4;
  uint64 compute_units_consumed     = 5;
  repeated Instruction instructions = 6;
  repeated Log logs                 = 7;
}

// -----------------------------------------------------------------------------
// Instruction + typed payloads
// -----------------------------------------------------------------------------
message Instruction {
  bytes  program_id = 1;
  uint32 stack_height = 2;
  oneof instruction {
    BuyExactInInstruction buy_exact_in     = 3;
    BuyExactOutInstruction buy_exact_out   = 4;
    SellExactInInstruction sell_exact_in   = 5;
    SellExactOutInstruction sell_exact_out = 6;
  }
}

// Accounts shared by trade instructions
message TradeAccounts {
  bytes payer               = 1;
  bytes authority           = 2;
  bytes global_config       = 3;
  bytes platform_config     = 4;
  bytes pool_state          = 5;
  bytes user_base_token     = 6;
  bytes user_quote_token    = 7;
  bytes base_vault          = 8;
  bytes quote_vault         = 9;
  bytes base_token_mint     = 10;
  bytes quote_token_mint    = 11;
  bytes base_token_program  = 12;
  bytes quote_token_program = 13;
  bytes event_authority     = 14;
  bytes program             = 15;
}

message BuyExactInInstruction {
  TradeAccounts accounts = 1;
  uint64 amount_in = 2;
  uint64 minimum_amount_out = 3;
  uint64 share_fee_rate = 4;
}

message BuyExactOutInstruction {
  TradeAccounts accounts = 1;
  uint64 amount_out = 2;
  uint64 maximum_amount_in = 3;
  uint64 share_fee_rate = 4;
}

message SellExactInInstruction {
  TradeAccounts accounts = 1;
  uint64 amount_in = 2;
  uint64 minimum_amount_out = 3;
  uint64 share_fee_rate = 4;
}

message SellExactOutInstruction {
  TradeAccounts accounts = 1;
  uint64 amount_out = 2;
  uint64 maximum_amount_in = 3;
  uint64 share_fee_rate = 4;
}

// -----------------------------------------------------------------------------
// Logs
// -----------------------------------------------------------------------------
message Log {
  bytes program_id = 1;
  uint32 invoke_depth = 2;
  oneof log {
    ClaimVestedLog claim_vested = 3;
    CreateVestingLog create_vesting = 4;
    PoolCreateLog pool_create = 5;
    TradeLog trade = 6;
  }
}

message ClaimVestedLog {
  bytes pool_state = 1;
  bytes beneficiary = 2;
  uint64 claim_amount = 3;
}

message CreateVestingLog {
  bytes pool_state = 1;
  bytes beneficiary = 2;
  uint64 share_amount = 3;
}

message PoolCreateLog {
  bytes pool_state = 1;
  bytes creator = 2;
  bytes config = 3;
  MintParams base_mint_param = 4;
  CurveParams curve_param = 5;
  VestingParams vesting_param = 6;
  AmmCreatorFeeOn amm_fee_on = 7;
}

message MintParams {
  uint32 decimals = 1;
  string name = 2;
  string symbol = 3;
  string uri = 4;
}

message CurveParams {
  oneof curve {
    ConstantCurve constant = 1;
    FixedCurve fixed = 2;
    LinearCurve linear = 3;
  }
}

message ConstantCurve {
  uint64 supply = 1;
  uint64 total_base_sell = 2;
  uint64 total_quote_fund_raising = 3;
  uint32 migrate_type = 4;
}

message FixedCurve {
  uint64 supply = 1;
  uint64 total_quote_fund_raising = 2;
  uint32 migrate_type = 3;
}

message LinearCurve {
  uint64 supply = 1;
  uint64 total_quote_fund_raising = 2;
  uint32 migrate_type = 3;
}

message VestingParams {
  uint64 total_locked_amount = 1;
  uint64 cliff_period = 2;
  uint64 unlock_period = 3;
}

enum AmmCreatorFeeOn {
  QUOTE_TOKEN = 0;
  BOTH_TOKEN = 1;
}

message TradeLog {
  bytes pool_state       = 1;
  uint64 total_base_sell = 2;
  uint64 virtual_base    = 3;
  uint64 virtual_quote   = 4;
  uint64 real_base_before  = 5;
  uint64 real_quote_before = 6;
  uint64 real_base_after   = 7;
  uint64 real_quote_after  = 8;
  uint64 amount_in       = 9;
  uint64 amount_out      = 10;
  uint64 protocol_fee    = 11;
  uint64 platform_fee    = 12;
  uint64 creator_fee     = 13;
  uint64 share_fee       = 14;
  TradeDirection trade_direction = 15;
  PoolStatus pool_status        = 16;
  bool exact_in           = 17;
}

enum TradeDirection {
  BUY = 0;
  SELL = 1;
}

enum PoolStatus {
  FUND    = 0;
  MIGRATE = 1;
  TRADE   = 2;
}

